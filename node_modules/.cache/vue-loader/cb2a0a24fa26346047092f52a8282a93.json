{"remainingRequest":"/Users/zhangsir/Desktop/ymyu/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/zhangsir/Desktop/ymyu/src/page/playlist-detail/index.vue?vue&type=style&index=0&id=2731553c&lang=scss&scoped=true&","dependencies":[{"path":"/Users/zhangsir/Desktop/ymyu/src/page/playlist-detail/index.vue","mtime":1592641032493},{"path":"/Users/zhangsir/Desktop/ymyu/node_modules/css-loader/index.js","mtime":499162500000},{"path":"/Users/zhangsir/Desktop/ymyu/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/zhangsir/Desktop/ymyu/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/zhangsir/Desktop/ymyu/node_modules/sass-loader/lib/loader.js","mtime":1533139052000},{"path":"/Users/zhangsir/Desktop/ymyu/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zhangsir/Desktop/ymyu/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n.playlist-detail {\n  width: 100%;\n\n  .tabs-wrap {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin: 0 24px;\n    border-bottom: 1px solid var(--border);\n\n    .input {\n      width: 125px;\n\n      &:not(:hover) {\n        &.inactive {\n          /deep/.el-input__inner {\n            background: transparent !important;\n          }\n        }\n      }\n    }\n  }\n\n  .empty {\n    @include flex-center;\n    height: 200px;\n\n    .keyword {\n      color: $blue;\n    }\n  }\n\n  .comments {\n    padding: 16px 32px;\n  }\n}\n",{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqIA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/page/playlist-detail","sourcesContent":["// 歌单详情页面\n<template>\n  <div class=\"playlist-detail\" v-if=\"playlist.id\">\n    <DetailHeader ref=\"header\" :playlist=\"playlist\" :songs=\"songs\" />\n    <div class=\"tabs-wrap\">\n      <Tabs :tabs=\"tabs\" type=\"theme\" v-model=\"activeTab\" />\n      <el-input\n        :class=\"getInputCls()\"\n        @blur=\"onInputBlur\"\n        @focus=\"onInputFocus\"\n        class=\"input\"\n        placeholder=\"搜索歌单音乐\"\n        prefix-icon=\"el-icon-search\"\n        v-model=\"searchValue\"\n        v-show=\"activeTab === SONG_IDX\"\n      ></el-input>\n    </div>\n    <div class=\"empty\" v-if=\"searchValue && !filteredSongs.length\">\n      未能找到和\n      <span class=\"keyword\">“{{ searchValue }}”</span>\n      相关的任何音乐\n    </div>\n    <SongTable\n      :highlightText=\"searchValue\"\n      :songs=\"filteredSongs\"\n      class=\"table\"\n      v-show=\"activeTab === SONG_IDX\"\n    />\n    <div class=\"comments\" v-show=\"activeTab === COMMENT_IDX\">\n      <Comments :id=\"id\" @update=\"onCommentsUpdate\" type=\"playlist\" />\n    </div>\n  </div>\n</template>\n\n<script>\nimport DetailHeader from \"./header\"\nimport SongTable from \"@/components/song-table\"\nimport Comments from \"@/components/comments\"\nimport { createSong, scrollInto } from \"@/utils\"\nimport { getListDetail } from \"@/api\"\nimport { getSongDetail } from \"@/api\"\n\nconst MAX = 500\nconst SONG_IDX = 0\nconst COMMENT_IDX = 1\nexport default {\n  metaInfo() {\n    return {\n      title: this.playlist.name,\n    }\n  },\n  async created() {\n    this.SONG_IDX = SONG_IDX\n    this.COMMENT_IDX = COMMENT_IDX\n  },\n  data() {\n    return {\n      tabs: [\"歌曲列表\", \"评论\"],\n      activeTab: SONG_IDX,\n      playlist: {},\n      songs: [],\n      searchValue: \"\",\n      inputFocus: false,\n    }\n  },\n  methods: {\n    async init() {\n      const { playlist } = await getListDetail({ id: this.id })\n      this.playlist = playlist\n      this.genSonglist(playlist)\n    },\n    async genSonglist(playlist) {\n      const trackIds = playlist.trackIds.map(({ id }) => id)\n      const songDetails = await getSongDetail(trackIds.slice(0, MAX))\n      const songs = songDetails.songs.map(({ id, name, al, ar, mv, dt }) =>\n        createSong({\n          id,\n          name,\n          artists: ar,\n          duration: dt,\n          mvId: mv,\n          albumName: al.name,\n          img: al.picUrl,\n        }),\n      )\n      this.songs = songs\n    },\n    onCommentsUpdate({ total }) {\n      this.tabs.splice(COMMENT_IDX, 1, `评论(${total})`)\n    },\n    onInputFocus() {\n      this.inputFocus = true\n    },\n    onInputBlur() {\n      this.inputFocus = false\n    },\n    getInputCls() {\n      return !this.inputFocus ? \"inactive\" : \"\"\n    },\n    scrollToHeader() {\n      const { header } = this.$refs\n      if (header) {\n        scrollInto(header.$el)\n      }\n    },\n  },\n  computed: {\n    id() {\n      return Number(this.$route.params.id)\n    },\n    filteredSongs() {\n      return this.songs.filter(({ name, artistsText, albumName }) =>\n        `${name}${artistsText}${albumName}`\n          .toLowerCase()\n          .includes(this.searchValue.toLowerCase()),\n      )\n    },\n  },\n  watch: {\n    id: {\n      handler() {\n        this.searchValue = \"\"\n        this.init()\n        this.scrollToHeader()\n      },\n      immediate: true,\n    },\n  },\n  components: { DetailHeader, SongTable, Comments },\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.playlist-detail {\n  width: 100%;\n\n  .tabs-wrap {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin: 0 24px;\n    border-bottom: 1px solid var(--border);\n\n    .input {\n      width: 125px;\n\n      &:not(:hover) {\n        &.inactive {\n          /deep/.el-input__inner {\n            background: transparent !important;\n          }\n        }\n      }\n    }\n  }\n\n  .empty {\n    @include flex-center;\n    height: 200px;\n\n    .keyword {\n      color: $blue;\n    }\n  }\n\n  .comments {\n    padding: 16px 32px;\n  }\n}\n</style>\n"]}]}