{"remainingRequest":"/Users/zhangsir/Desktop/muise/node_modules/babel-loader/lib/index.js!/Users/zhangsir/Desktop/muise/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/zhangsir/Desktop/muise/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/zhangsir/Desktop/muise/src/components/user.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/zhangsir/Desktop/muise/src/components/user.vue","mtime":1592641032491},{"path":"/Users/zhangsir/Desktop/muise/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zhangsir/Desktop/muise/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/zhangsir/Desktop/muise/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zhangsir/Desktop/muise/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es7.object.get-own-property-descriptors\";\nimport \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.object.keys\";\nimport \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"/Users/zhangsir/Desktop/muise/node_modules/@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _defineProperty from \"/Users/zhangsir/Desktop/muise/node_modules/@babel/runtime-corejs2/helpers/esm/defineProperty\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(source, true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(source).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport storage from \"good-storage\";\nimport { UID_KEY, isDef } from \"@/utils\";\nimport { confirm } from \"@/base/confirm\";\nimport { mapActions as mapUserActions, mapState as mapUserState, mapGetters as mapUserGetters } from \"@/store/helper/user\";\nexport default {\n  // 自动登录\n  created: function created() {\n    var uid = storage.get(UID_KEY);\n\n    if (isDef(uid)) {\n      this.onLogin(uid);\n    }\n  },\n  data: function data() {\n    return {\n      visible: false,\n      loading: false,\n      uid: \"\"\n    };\n  },\n  methods: _objectSpread({\n    onOpenModal: function onOpenModal() {\n      this.visible = true;\n    },\n    onCloseModal: function onCloseModal() {\n      this.visible = false;\n    },\n    onLogin: function () {\n      var _onLogin = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee(uid) {\n        var _this = this;\n\n        var success;\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                this.loading = true;\n                _context.next = 3;\n                return this.login(uid).finally(function () {\n                  _this.loading = false;\n                });\n\n              case 3:\n                success = _context.sent;\n\n                if (success) {\n                  this.onCloseModal();\n                }\n\n              case 5:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function onLogin(_x) {\n        return _onLogin.apply(this, arguments);\n      }\n\n      return onLogin;\n    }(),\n    onLogout: function onLogout() {\n      var _this2 = this;\n\n      confirm(\"确定要注销吗？\", function () {\n        _this2.logout();\n      });\n    }\n  }, mapUserActions([\"login\", \"logout\"])),\n  computed: _objectSpread({}, mapUserState([\"user\"]), {}, mapUserGetters([\"isLogin\"])),\n  components: {}\n};",{"version":3,"sources":["user.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsDA,OAAA,OAAA,MAAA,cAAA;AACA,SAAA,OAAA,EAAA,KAAA,QAAA,SAAA;AACA,SAAA,OAAA,QAAA,gBAAA;AACA,SACA,UAAA,IAAA,cADA,EAEA,QAAA,IAAA,YAFA,EAGA,UAAA,IAAA,cAHA,QAIA,qBAJA;AAMA,eAAA;AACA;AACA,EAAA,OAFA,qBAEA;AACA,QAAA,GAAA,GAAA,OAAA,CAAA,GAAA,CAAA,OAAA,CAAA;;AACA,QAAA,KAAA,CAAA,GAAA,CAAA,EAAA;AACA,WAAA,OAAA,CAAA,GAAA;AACA;AACA,GAPA;AAQA,EAAA,IARA,kBAQA;AACA,WAAA;AACA,MAAA,OAAA,EAAA,KADA;AAEA,MAAA,OAAA,EAAA,KAFA;AAGA,MAAA,GAAA,EAAA;AAHA,KAAA;AAKA,GAdA;AAeA,EAAA,OAAA;AACA,IAAA,WADA,yBACA;AACA,WAAA,OAAA,GAAA,IAAA;AACA,KAHA;AAIA,IAAA,YAJA,0BAIA;AACA,WAAA,OAAA,GAAA,KAAA;AACA,KANA;AAOA,IAAA,OAPA;AAAA;AAAA;AAAA,+CAOA,GAPA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAQA,qBAAA,OAAA,GAAA,IAAA;AARA;AAAA,uBASA,KAAA,KAAA,CAAA,GAAA,EAAA,OAAA,CAAA,YAAA;AACA,kBAAA,KAAA,CAAA,OAAA,GAAA,KAAA;AACA,iBAFA,CATA;;AAAA;AASA,gBAAA,OATA;;AAYA,oBAAA,OAAA,EAAA;AACA,uBAAA,YAAA;AACA;;AAdA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAgBA,IAAA,QAhBA,sBAgBA;AAAA;;AACA,MAAA,OAAA,CAAA,SAAA,EAAA,YAAA;AACA,QAAA,MAAA,CAAA,MAAA;AACA,OAFA,CAAA;AAGA;AApBA,KAqBA,cAAA,CAAA,CAAA,OAAA,EAAA,QAAA,CAAA,CArBA,CAfA;AAsCA,EAAA,QAAA,oBACA,YAAA,CAAA,CAAA,MAAA,CAAA,CADA,MAEA,cAAA,CAAA,CAAA,SAAA,CAAA,CAFA,CAtCA;AA0CA,EAAA,UAAA,EAAA;AA1CA,CAAA","sourcesContent":["<template>\n  <div class=\"user\">\n    <!-- 登录前 -->\n    <div @click=\"onOpenModal\" class=\"login-trigger\" v-if=\"!isLogin\">\n      <i class=\"user-icon iconfont icon-yonghu\" />\n      <p class=\"user-name\">未登录</p>\n    </div>\n    <!-- 登录后 -->\n    <div @click=\"onLogout\" class=\"logined-user\" v-else>\n      <img v-lazy=\"$utils.genImgUrl(user.avatarUrl, 80)\" class=\"avatar\" />\n      <p class=\"user-name\">{{ user.nickname }}</p>\n    </div>\n\n    <!-- 登录框 -->\n    <el-dialog\n      :modal=\"false\"\n      :visible.sync=\"visible\"\n      :width=\"$utils.toRem(320)\"\n    >\n      <p slot=\"title\">登录</p>\n      <div class=\"login-body\">\n        <el-input\n          class=\"input\"\n          placeholder=\"请输入您的网易云uid\"\n          v-model=\"uid\"\n        />\n        <div class=\"login-help\">\n          <p class=\"help\">\n            1、请\n            <a href=\"http://music.163.com\" target=\"_blank\"\n              >点我(http://music.163.com)</a\n            >打开网易云音乐官网\n          </p>\n          <p class=\"help\">2、点击页面右上角的“登录”</p>\n          <p class=\"help\">3、点击您的头像，进入我的主页</p>\n          <p class=\"help\">\n            4、复制浏览器地址栏 /user/home?id= 后面的数字（网易云 UID）\n          </p>\n        </div>\n      </div>\n      <span class=\"dialog-footer\" slot=\"footer\">\n        <el-button\n          :loading=\"loading\"\n          @click=\"onLogin(uid)\"\n          class=\"login-btn\"\n          type=\"primary\"\n          >登 录</el-button\n        >\n      </span>\n    </el-dialog>\n  </div>\n</template>\n\n<script type=\"text/ecmascript-6\">\nimport storage from \"good-storage\"\nimport { UID_KEY, isDef } from \"@/utils\"\nimport { confirm } from \"@/base/confirm\"\nimport {\n  mapActions as mapUserActions,\n  mapState as mapUserState,\n  mapGetters as mapUserGetters\n} from \"@/store/helper/user\"\n\nexport default {\n  // 自动登录\n  created() {\n    const uid = storage.get(UID_KEY)\n    if (isDef(uid)) {\n      this.onLogin(uid)\n    }\n  },\n  data() {\n    return {\n      visible: false,\n      loading: false,\n      uid: \"\"\n    }\n  },\n  methods: {\n    onOpenModal() {\n      this.visible = true\n    },\n    onCloseModal() {\n      this.visible = false\n    },\n    async onLogin(uid) {\n      this.loading = true\n      const success = await this.login(uid).finally(() => {\n        this.loading = false\n      })\n      if (success) {\n        this.onCloseModal()\n      }\n    },\n    onLogout() {\n      confirm(\"确定要注销吗？\", () => {\n        this.logout()\n      })\n    },\n    ...mapUserActions([\"login\", \"logout\"])\n  },\n  computed: {\n    ...mapUserState([\"user\"]),\n    ...mapUserGetters([\"isLogin\"])\n  },\n  components: {}\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.user {\n  padding: 16px;\n  padding-bottom: 0;\n  margin-bottom: 12px;\n\n  .login-trigger {\n    display: flex;\n    align-items: center;\n    cursor: pointer;\n  }\n  .user-icon {\n    font-size: 24px;\n  }\n\n  .user-name {\n    margin-left: 8px;\n  }\n\n  .logout {\n    transform: translateY(1px);\n    margin-left: 8px;\n    color: var(--font-color-shallow-grey);\n  }\n\n  .login-body {\n    .input {\n      margin-bottom: 16px;\n    }\n\n    .login-help {\n      .help {\n        margin-bottom: 4px;\n      }\n    }\n  }\n\n  .login-btn {\n    width: 100%;\n    padding: 8px 0;\n  }\n\n  .logined-user {\n    display: flex;\n    align-items: center;\n    cursor: pointer;\n\n    .avatar {\n      @include round(40px);\n    }\n  }\n}\n</style>\n"],"sourceRoot":"src/components"}]}