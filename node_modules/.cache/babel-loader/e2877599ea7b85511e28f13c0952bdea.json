{"remainingRequest":"/Users/zhangsir/Desktop/ymyu/node_modules/thread-loader/dist/cjs.js!/Users/zhangsir/Desktop/ymyu/node_modules/babel-loader/lib/index.js!/Users/zhangsir/Desktop/ymyu/node_modules/eslint-loader/index.js??ref--13-0!/Users/zhangsir/Desktop/ymyu/src/store/modules/user/actions.js","dependencies":[{"path":"/Users/zhangsir/Desktop/ymyu/src/store/modules/user/actions.js","mtime":1592641032496},{"path":"/Users/zhangsir/Desktop/ymyu/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zhangsir/Desktop/ymyu/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zhangsir/Desktop/ymyu/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/zhangsir/Desktop/ymyu/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"/Users/zhangsir/Desktop/ymyu/node_modules/@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport storage from 'good-storage';\nimport { UID_KEY } from '@/utils';\nimport { notify, isDef } from '@/utils';\nimport { getUserDetail, getUserPlaylist } from \"@/api\";\nexport default {\n  login: function () {\n    var _login = _asyncToGenerator(\n    /*#__PURE__*/\n    regeneratorRuntime.mark(function _callee(_ref, uid) {\n      var commit, error, user, profile, _ref2, playlist;\n\n      return regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              commit = _ref.commit;\n\n              error = function error() {\n                notify.error('登录失败，请输入正确的uid。');\n                return false;\n              };\n\n              if (isDef(uid)) {\n                _context.next = 4;\n                break;\n              }\n\n              return _context.abrupt(\"return\", error());\n\n            case 4:\n              _context.prev = 4;\n              _context.next = 7;\n              return getUserDetail(uid);\n\n            case 7:\n              user = _context.sent;\n              profile = user.profile;\n              commit('setUser', profile);\n              storage.set(UID_KEY, profile.userId);\n              _context.next = 16;\n              break;\n\n            case 13:\n              _context.prev = 13;\n              _context.t0 = _context[\"catch\"](4);\n              return _context.abrupt(\"return\", error());\n\n            case 16:\n              _context.next = 18;\n              return getUserPlaylist(uid);\n\n            case 18:\n              _ref2 = _context.sent;\n              playlist = _ref2.playlist;\n              commit('setUserPlaylist', playlist);\n              return _context.abrupt(\"return\", true);\n\n            case 22:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[4, 13]]);\n    }));\n\n    function login(_x, _x2) {\n      return _login.apply(this, arguments);\n    }\n\n    return login;\n  }(),\n  logout: function logout(_ref3) {\n    var commit = _ref3.commit;\n    commit('setUser', {});\n    commit('setUserPlaylist', []);\n    storage.set(UID_KEY, null);\n  }\n};",{"version":3,"sources":["/Users/zhangsir/Desktop/ymyu/src/store/modules/user/actions.js"],"names":["storage","UID_KEY","notify","isDef","getUserDetail","getUserPlaylist","login","uid","commit","error","user","profile","set","userId","playlist","logout"],"mappings":";;AAAA,OAAOA,OAAP,MAAoB,cAApB;AACA,SAASC,OAAT,QAAwB,SAAxB;AACA,SAASC,MAAT,EAAiBC,KAAjB,QAA8B,SAA9B;AACA,SAASC,aAAT,EAAwBC,eAAxB,QAA+C,OAA/C;AAEA,eAAe;AACPC,EAAAA,KADO;AAAA;AAAA;AAAA,mDACWC,GADX;AAAA;;AAAA;AAAA;AAAA;AAAA;AACCC,cAAAA,MADD,QACCA,MADD;;AAELC,cAAAA,KAFK,GAEG,SAARA,KAAQ,GAAM;AAClBP,gBAAAA,MAAM,CAACO,KAAP,CAAa,iBAAb;AACA,uBAAO,KAAP;AACD,eALU;;AAAA,kBAONN,KAAK,CAACI,GAAD,CAPC;AAAA;AAAA;AAAA;;AAAA,+CAQFE,KAAK,EARH;;AAAA;AAAA;AAAA;AAAA,qBAYUL,aAAa,CAACG,GAAD,CAZvB;;AAAA;AAYHG,cAAAA,IAZG;AAaDC,cAAAA,OAbC,GAaWD,IAbX,CAaDC,OAbC;AAcTH,cAAAA,MAAM,CAAC,SAAD,EAAYG,OAAZ,CAAN;AACAX,cAAAA,OAAO,CAACY,GAAR,CAAYX,OAAZ,EAAqBU,OAAO,CAACE,MAA7B;AAfS;AAAA;;AAAA;AAAA;AAAA;AAAA,+CAiBFJ,KAAK,EAjBH;;AAAA;AAAA;AAAA,qBAoBgBJ,eAAe,CAACE,GAAD,CApB/B;;AAAA;AAAA;AAoBHO,cAAAA,QApBG,SAoBHA,QApBG;AAqBXN,cAAAA,MAAM,CAAC,iBAAD,EAAoBM,QAApB,CAAN;AArBW,+CAsBJ,IAtBI;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAwBbC,EAAAA,MAxBa,yBAwBM;AAAA,QAAVP,MAAU,SAAVA,MAAU;AACjBA,IAAAA,MAAM,CAAC,SAAD,EAAY,EAAZ,CAAN;AACAA,IAAAA,MAAM,CAAC,iBAAD,EAAoB,EAApB,CAAN;AACAR,IAAAA,OAAO,CAACY,GAAR,CAAYX,OAAZ,EAAqB,IAArB;AACD;AA5BY,CAAf","sourcesContent":["import storage from 'good-storage'\nimport { UID_KEY } from '@/utils'\nimport { notify, isDef } from '@/utils'\nimport { getUserDetail, getUserPlaylist } from \"@/api\"\n\nexport default {\n  async login({ commit }, uid) {\n    const error = () => {\n      notify.error('登录失败，请输入正确的uid。')\n      return false\n    }\n    \n    if (!isDef(uid)) {\n      return error()\n    }\n\n    try {\n      const user = await getUserDetail(uid)\n      const { profile } = user\n      commit('setUser', profile)\n      storage.set(UID_KEY, profile.userId)\n    } catch (e) {\n      return error()\n    }\n\n    const { playlist } = await getUserPlaylist(uid)\n    commit('setUserPlaylist', playlist)\n    return true\n  },\n  logout({ commit }) {\n    commit('setUser', {})\n    commit('setUserPlaylist', [])\n    storage.set(UID_KEY, null)\n  }\n}\n"]}]}